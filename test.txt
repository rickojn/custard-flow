Running main() from /home/rickojn/coding/custard-flow/build/_deps/googletest-src/googletest/src/gtest_main.cc
[==========] Running 6 tests from 5 test suites.
[----------] Global test environment set-up.
[----------] 1 test from MinTest
[ RUN      ] MinTest.BasicFunctionality
[       OK ] MinTest.BasicFunctionality (0 ms)
[----------] 1 test from MinTest (0 ms total)

[----------] 1 test from MatmulNaiveTest
[ RUN      ] MatmulNaiveTest.BasicFunctionality
[       OK ] MatmulNaiveTest.BasicFunctionality (0 ms)
[----------] 1 test from MatmulNaiveTest (0 ms total)

[----------] 1 test from MatmulBackwardsTest
[ RUN      ] MatmulBackwardsTest.BasicFunctionality
[       OK ] MatmulBackwardsTest.BasicFunctionality (0 ms)
[----------] 1 test from MatmulBackwardsTest (0 ms total)

[----------] 1 test from MatrixMultiplicationTest
[ RUN      ] MatrixMultiplicationTest.CompareWithLibTorch
Matrix A:
0.882269 0.915004 0.382864 
0.959306 0.390448 0.600895 
0.256572 0.793641 0.940771 
Matrix B:
0.133186 0.934598 0.59358 
0.869404 0.567715 0.741094 
0.429404 0.885443 0.573904 
Expected Result:
1.07742 1.68303 1.42153 
0.725251 1.65029 1.20364 
1.12814 1.52335 1.28037 
My Result:
1.07742 1.68303 1.42153 
0.725251 1.65029 1.20364 
1.12814 1.52335 1.28037 
Dimensions: A(3, 3), B(3, 3), Result(3, 3)
[       OK ] MatrixMultiplicationTest.CompareWithLibTorch (879 ms)
[----------] 1 test from MatrixMultiplicationTest (879 ms total)

[----------] 2 tests from MatrixMultiplicationBackwardsTest
[ RUN      ] MatrixMultiplicationBackwardsTest.MatmulBackwards
Testing matmul_backwards function with autograd comparison.
Input:
 0.8823  0.9150  0.3829
 0.9593  0.3904  0.6009
 0.2566  0.7936  0.9408
[ CPUFloatType{3,3} ]
Weights:
 0.1332  0.9346  0.5936
 0.8694  0.5677  0.7411
 0.4294  0.8854  0.5739
[ CPUFloatType{3,3} ]
Grad Output:
 0.2666  0.6274  0.2696
 0.4414  0.2969  0.8317
 0.1053  0.2695  0.3588
[ CPUFloatType{3,3} ]
Input Gradient (Torch):
0.781965,0.787801,0.824784,
0.829957,1.16865,0.929738,
0.47888,0.510471,0.489769,
Weights Gradient (Torch):
0.685619,0.907562,1.12779,
0.499834,0.903933,0.856213,
0.466354,0.672179,0.940549,
Input Gradient:
0.781965 0.787801 0.824784 
0.829957 1.16865 0.929738 
0.47888 0.510471 0.489769 
Weights Gradient:
0.22854 0.166611 0.155451 
0.302521 0.301311 0.22406 
0.37593 0.285404 0.313516 
[       OK ] MatrixMultiplicationBackwardsTest.MatmulBackwards (18 ms)
[ RUN      ] MatrixMultiplicationBackwardsTest.SIMDMatmulBackwards
Testing simd_matmul_backwards function with autograd comparison.
Input:
 0.8823  0.9150  0.3829
 0.9593  0.3904  0.6009
 0.2566  0.7936  0.9408
[ CPUFloatType{3,3} ]
Weights:
 0.1332  0.9346  0.5936
 0.8694  0.5677  0.7411
 0.4294  0.8854  0.5739
[ CPUFloatType{3,3} ]
Grad Output:
 0.2666  0.6274  0.2696
 0.4414  0.2969  0.8317
 0.1053  0.2695  0.3588
[ CPUFloatType{3,3} ]
matmul simd backward weight grads ...
Time spent in simd_matmul_backward weight grads: 0.000004 seconds
matmul simd backward input grads ...
Time spent for input activation grads: 0.000001 seconds
/home/rickojn/coding/custard-flow/test/cf_test.cc:211: Failure
Expected equality of these values:
  input_grad_computed[i * 3 + j]
    Which is: 0.7918008
  input_grad[i * 3 + j]
    Which is: 0.78196537
Mismatch in input gradient at (0, 0)
/home/rickojn/coding/custard-flow/test/cf_test.cc:213: Failure
Expected equality of these values:
  weights_grad_computed[i * 3 + j] * 3
    Which is: 0
  weights_grad[j * 3 + i]
    Which is: 0.68561888
Mismatch in weights gradient at (0, 0)
/home/rickojn/coding/custard-flow/test/cf_test.cc:211: Failure
Expected equality of these values:
  input_grad_computed[i * 3 + j]
    Which is: 0.96200812
  input_grad[i * 3 + j]
    Which is: 0.78780079
Mismatch in input gradient at (0, 1)
/home/rickojn/coding/custard-flow/test/cf_test.cc:213: Failure
Expected equality of these values:
  weights_grad_computed[i * 3 + j] * 3
    Which is: 0
  weights_grad[j * 3 + i]
    Which is: 0.49983367
Mismatch in weights gradient at (0, 1)
/home/rickojn/coding/custard-flow/test/cf_test.cc:211: Failure
Expected equality of these values:
  input_grad_computed[i * 3 + j]
    Which is: 0.87333906
  input_grad[i * 3 + j]
    Which is: 0.82478392
Mismatch in input gradient at (0, 2)
/home/rickojn/coding/custard-flow/test/cf_test.cc:213: Failure
Expected equality of these values:
  weights_grad_computed[i * 3 + j] * 3
    Which is: 0
  weights_grad[j * 3 + i]
    Which is: 0.4663544
Mismatch in weights gradient at (0, 2)
/home/rickojn/coding/custard-flow/test/cf_test.cc:211: Failure
Expected equality of these values:
  input_grad_computed[i * 3 + j]
    Which is: 0.77890372
  input_grad[i * 3 + j]
    Which is: 0.82995665
Mismatch in input gradient at (1, 0)
/home/rickojn/coding/custard-flow/test/cf_test.cc:213: Failure
Expected equality of these values:
  weights_grad_computed[i * 3 + j] * 3
    Which is: 0
  weights_grad[j * 3 + i]
    Which is: 0.9075619
Mismatch in weights gradient at (1, 0)
